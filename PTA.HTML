<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PTA係一覧</title>
<style>
  /* 横スクロール用のラッパー */
  .table-wrapper {
    max-width: 600px;   /* 表示幅の最大値 */
    overflow-x: auto;   /* 横スクロール */
    margin: 0 auto;     /* 中央寄せ */
  }

  table {
    border-collapse: collapse;
    width: 100%;
    min-width: 500px;   /* 横幅が狭すぎないように */
  }

  th, td {
    border: 1px solid #999;
    padding: 4px 6px;
    text-align: center;
    font-size: 14px;
  }

  td.disabled {
    background-color: #eee;
    color: #666;
  }

  th {
    background-color: #f2f2f2;
  }
</style>
</head>
<body>

<h2>PTA係一覧</h2>

<div class="table-wrapper">
  <table id="ptaTable">
    <thead>
      <tr>
        <th>係</th>
        <th>1人目</th>
        <th>2人目</th>
        <th>3人目</th>
      </tr>
    </thead>
    <tbody>
      <tr data-role="代表委員">
        <td>代表委員</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
      <tr data-role="地区リーダー">
        <td>地区リーダー</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
      <tr data-role="正地区委員">
        <td>正地区委員</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
      <tr data-role="副地区委員">
        <td>副地区委員</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
      <tr data-role="クラス委員">
        <td>クラス委員</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
      <tr data-role="交安協(3年)">
        <td>交安協(3年)</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
      <tr data-role="卒対(6年)">
        <td>卒対(6年)</td>
        <td><input type="checkbox" data-child="1"></td>
        <td><input type="checkbox" data-child="2"></td>
        <td><input type="checkbox" data-child="3"></td>
      </tr>
    </tbody>
  </table>
</div>

<script>
const exemptionRules = {
  "代表委員": ["代表委員", "地区リーダー", "交安協(3年)", "卒対(6年)"],
  "地区リーダー": ["代表委員", "地区リーダー", "交安協(3年)", "卒対(6年)", "正地区委員"],
  "正地区委員": ["地区リーダー", "正地区委員"],
  "副地区委員": ["正地区委員", "副地区委員"],
  "クラス委員": ["代表委員", "クラス委員", "交安協(3年)", "卒対(6年)"],
  "交安協(3年)": ["代表委員", "クラス委員", "交安協(3年)", "卒対(6年)"],
  "卒対(6年)": ["代表委員", "クラス委員", "交安協(3年)", "卒対(6年)"]
};

const multiChildExempt = ["代表委員","地区リーダー"]; // 兄弟全員免除

const rows = document.querySelectorAll("#ptaTable tbody tr");

rows.forEach(row => {
  row.querySelectorAll("input[type='checkbox']").forEach(cb => {
    cb.addEventListener("change", () => {
      // グレー表示リセット
      rows.forEach(r => r.querySelectorAll("td").forEach(td => td.classList.remove("disabled")));

      // チェックされた全ボックス
      const checkedBoxes = Array.from(document.querySelectorAll("input[type='checkbox']:checked"));

      checkedBoxes.forEach(box => {
        const role = box.closest("tr").getAttribute("data-role");
        const child = box.getAttribute("data-child");

        const exemptList = exemptionRules[role] || [];

        exemptList.forEach(ex => {
          const targetRow = document.querySelector(`[data-role='${ex}']`);
          if (!targetRow) return;

          if (multiChildExempt.includes(role)) {
            // 兄弟全員列をグレーアウト
            targetRow.querySelectorAll("td input").forEach(input => input.parentNode.classList.add("disabled"));
          } else {
            // その子のみグレーアウト
            const targetCell = targetRow.querySelector(`input[data-child='${child}']`).parentNode;
            targetCell.classList.add("disabled");
          }
        });
      });
    });
  });
});
</script>

</body>
</html>